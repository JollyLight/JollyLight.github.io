<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D打印耗材成本计算器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 配置Tailwind自定义颜色和字体 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        neutral: '#64748B',
                        light: '#F1F5F9',
                        dark: '#1E293B'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .card-shadow {
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.02);
            }
            .input-focus {
                @apply focus:ring-2 focus:ring-primary/50 focus:border-primary focus:outline-none;
            }
            .transition-custom {
                @apply transition-all duration-300 ease-in-out;
            }
            .animate-fadeIn {
                animation: fadeIn 0.5s ease-in-out;
            }
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            /* 移除数字输入框的默认箭头 */
            input[type="number"]::-webkit-outer-spin-button,
            input[type="number"]::-webkit-inner-spin-button {
                -webkit-appearance: none;
                margin: 0;
            }
            input[type="number"] {
                -moz-appearance: textfield;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-light to-gray-200 min-h-screen flex items-center justify-center p-4 font-sans text-dark">
    <div class="w-full max-w-md">
        <!-- 计算器卡片 -->
        <div class="bg-white rounded-2xl p-8 card-shadow transform hover:scale-[1.01] transition-custom">
            <!-- 标题区域 -->
            <div class="text-center mb-8">
                <h1 class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-dark">3D打印耗材成本计算器</h1>
                <p class="text-neutral mt-2">快速计算您的3D打印材料成本</p>
            </div>
            
            <!-- 输入区域 -->
            <form id="calculator-form" class="space-y-6">
                <!-- 单卷耗材重量 -->
                <div class="space-y-2">
                    <label for="weight-per-spool" class="block text-sm font-medium text-neutral">
                        单卷耗材重量 (g)
                    </label>
                    <div>
                        <input type="number" id="weight-per-spool" min="1" class="w-full px-3 py-3 border border-gray-300 rounded-lg input-focus transition-custom" onwheel="return false;">
                    </div>
                </div>
                
                <!-- 单卷耗材价格 -->
                <div class="space-y-2">
                    <label for="price-per-spool" class="block text-sm font-medium text-neutral">
                        单卷耗材价格 (元)
                    </label>
                    <div>
                        <input type="number" id="price-per-spool" min="0.01" step="0.01" class="w-full px-3 py-3 border border-gray-300 rounded-lg input-focus transition-custom" onwheel="return false;">
                    </div>
                </div>
                
                <!-- 本次打印消耗重量 -->
                <div class="space-y-2">
                    <label for="used-weight" class="block text-sm font-medium text-neutral">
                        本次打印消耗重量 (g) <span class="text-red-500">*</span>
                    </label>
                    <div>
                        <input type="number" id="used-weight" placeholder="请输入消耗重量" min="0.01" step="0.01" required class="w-full px-3 py-3 border border-gray-300 rounded-lg input-focus transition-custom" onwheel="return false;">
                    </div>
                </div>
            </form>
            
            <!-- 结果显示区域 -->
            <div id="result" class="mt-8 hidden">
                <div class="border-t border-gray-200 pt-6">
                    <h2 class="text-lg font-medium text-neutral mb-4">计算结果</h2>
                    <div class="bg-light rounded-xl p-6 text-center">
                        <p class="text-neutral mb-2">本次打印耗材成本</p>
                        <p id="cost-result" class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold text-secondary"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 获取DOM元素
        const form = document.getElementById('calculator-form');
        const weightPerSpoolInput = document.getElementById('weight-per-spool');
        const pricePerSpoolInput = document.getElementById('price-per-spool');
        const usedWeightInput = document.getElementById('used-weight');
        const resultDiv = document.getElementById('result');
        const costResult = document.getElementById('cost-result');
        
        // 页面加载时从localStorage读取保存的数值
        document.addEventListener('DOMContentLoaded', function() {
            // 读取保存的单卷耗材重量，默认为1000g
            const savedWeight = localStorage.getItem('spoolWeight');
            if (savedWeight) {
                weightPerSpoolInput.value = savedWeight;
            } else {
                weightPerSpoolInput.value = 1000;
            }
            
            // 读取保存的单卷耗材价格，默认为60元
            const savedPrice = localStorage.getItem('spoolPrice');
            if (savedPrice) {
                pricePerSpoolInput.value = savedPrice;
            } else {
                pricePerSpoolInput.value = 60;
            }
            
            // 确保本次打印消耗重量为空
            usedWeightInput.value = '';
        });
        
        // 输入框变化时自动计算并保存参数
        const inputs = document.querySelectorAll('input');
        inputs.forEach(input => {
            input.addEventListener('input', function() {
                calculateCost();
                
                // 只保存单卷耗材重量和价格
                if (this.id === 'weight-per-spool' || this.id === 'price-per-spool') {
                    localStorage.setItem('spoolWeight', weightPerSpoolInput.value);
                    localStorage.setItem('spoolPrice', pricePerSpoolInput.value);
                }
            });
            
            input.addEventListener('change', function() {
                calculateCost();
                
                // 只保存单卷耗材重量和价格
                if (this.id === 'weight-per-spool' || this.id === 'price-per-spool') {
                    localStorage.setItem('spoolWeight', weightPerSpoolInput.value);
                    localStorage.setItem('spoolPrice', pricePerSpoolInput.value);
                }
            });
        });
        
        // 计算成本函数
        function calculateCost() {
            if (usedWeightInput.value && weightPerSpoolInput.value && pricePerSpoolInput.value) {
                const M = parseFloat(weightPerSpoolInput.value);
                const P = parseFloat(pricePerSpoolInput.value);
                const N = parseFloat(usedWeightInput.value);
                
                if (!isNaN(M) && !isNaN(P) && !isNaN(N) && N > 0) {
                    const Q = (N * P / M).toFixed(2);
                    costResult.textContent = `${Q} 元`;
                    resultDiv.classList.remove('hidden');
                    resultDiv.classList.add('animate-fadeIn');
                }
            }
        }
        
        // 阻止表单默认提交行为
        form.addEventListener('submit', function(e) {
            e.preventDefault();
        });
        
        // 输入框交互效果
        inputs.forEach(input => {
            input.addEventListener('focus', function() {
                this.parentElement.classList.add('scale-[1.02]');
            });
            
            input.addEventListener('blur', function() {
                this.parentElement.classList.remove('scale-[1.02]');
            });
        });
    </script>
</body>
</html>
    